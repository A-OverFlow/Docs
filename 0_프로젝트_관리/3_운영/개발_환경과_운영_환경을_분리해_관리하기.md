# 개발 환경과 운영 환경을 분리하기

<img width="20%" src="https://github.com/user-attachments/assets/d1799a17-34df-4315-9d5f-4ff5311c09d2"/>

_이미지 출처: https://www.freepik.com/icon/split-screen_8769192_

## **1. 왜 개발 환경과 운영 환경을 분리해야 할까요?**
**개발 환경**은 운영 서버와 분리된 공간에서 개발, 테스트, 디버깅을 자유롭게 수행할 수 있도록 구축한 환경을 의미합니다.<br/>
반면, **운영 환경**은 실제 사용자들이 서비스를 사용하는 환경을 뜻합니다.

왜 서버 환경을 이렇게 여러 개로 분류해 관리해야 할까요?

### **1.1. 안정성 확보**
개발 환경과 운영 환경을 분리하면 **서비스 운영에 안정성을 확보**할 수 있습니다.<br/>
당연하게도 운영 서버에 문제가 발생하면 사용자는 해당 서비스를 이용할 수 없게 됩니다.<br/>
따라서 새로운 기능이나 수정 사항을 운영 서버에 배포하기 전에, 개발 환경에서 충분히 이들을 검증하는 과정이 필요한데요,

개발 환경과 운영 환경을 철저히 분리하고 테스트와 검증 과정을 거친다면<br/>
예상치 못한 오류를 사전에 발견하고 수정할 수 있으며, 운영 환경에서 발생할 수 있는 장애를 최소화할 수 있습니다.

### **1.2. 생산성 향상**
개발 환경과 운영 환경을 분리하면 개발 환경에서 서비스를 자유롭게 테스트할 수 있으므로 개발 생산성을 향상시킬 수 있습니다.<br/>
운영 환경에서는 엄격한 접근 통제를 두고 변경을 최소화하여 안정성을 유지하는 반면,<br/>
**개발 환경에서는 신속한 개발 및 협업이 가능**해집니다.
<br/><br/>

---

## **2. 만약 서버가 한 대라면?**
일반적으로 개발 서버와 운영 서버는 완전히 분리해서 구성하는 것이 관례지만,<br/>
두 개의 서버 인스턴스를 사용하는 것이 어려운 상황이라면 Docker와 같은 컨테이너화 도구를 사용해<br/>
**하나의 서버에서 여러 컨테이너(개발용, 운영용)를 분리해 구축**하는 방법이 있습니다.
<br/><br/>

#### **개발-운영 웹 서비스를 서버 한 대에 구축하면, 어떻게 구분해 접근할까요?**
(1) 서브도메인 또는 URL 경로 분리
* 운영 환경: https://example.com
* 개발 환경: https://dev.example.com 또는 https://example.com/dev
* 이를 위해 Nginx 또는 Apache에서 별도의 가상 호스트(Virtual Host)를 설정할 수 있습니다.

(2) 포트 번호를 활용한 접근 분리
* 운영 환경: https://example.com:443
* 개발 환경: https://example.com:8080
* 같은 서버에서 실행되지만 다른 포트를 통해 접근할 수 있도록 설정할 수 있습니다.
<br/><br/>

---

## **3. 환경을 분리할 때 유의할 부분은?**
#### **데이터베이스 분리**
* 각 환경 별 데이터베이스 저장소를 분리하고, 접속 정보 등 설정을 구분하도록 합니다.

#### **로깅 및 모니터링 체계 구축**
* 운영 환경과 개발 환경에서 각각의 로그를 구분하여 관리해야 합니다.
* 로그 수준을 환경에 맞게 조정하여, 개발 환경에서는 디버깅을 쉽게 하고 운영 환경에서는 성능과 보안을 유지해야 합니다.
<br/><br/>

---

## **4. 개발-운영 환경 이외에 더 필요한 환경은?**
<img width="45%" src="https://github.com/user-attachments/assets/4dc8d2d0-642d-4b5b-9db0-f0d17f20e986"/>

개발 환경과 운영 환경 이외에 아래와 같은 환경을 구축할 수 있습니다.<br/>
꼭 모든 환경을 다 갖출 필요는 없으며, 프로젝트 상황에 따라서 각 환경을 합치거나 생략해도 됩니다.
* **통합 환경(Integration)**
  * 통합 개발 환경은, 여러개의 컴포넌트를 동시 개발하는 프로젝트가 있고, 각 컴포넌트가 다른 컴포넌트에 의존성이 존재할 때 컴포넌트를 통합 및 테스트하는 환경으로 사용합니다.
* **테스트 환경(Test)**
  * 기능 테스트와 비기능 테스트가 이뤄지는 환경입니다. 사용자의 요구사항이 충족되는지 확인합니다. 
  * QA 엔지니어가 사용하는 환경입니다. 
* **스테이징 환경(Staging)**
  * 운영 환경과 거의 동일한 환경에서 비기능적인 부분(Security, 성능, 장애 등)을 검증하는 환경입니다.
<br/><br/>

---

## **5. MSA 환경에서의 개발 및 운영 환경 구성**
#### MSA 환경에서 서비스가 점점 늘어날 경우, 어떻게 개발-운영 환경을 구성할까요?
* 마이크로서비스별로 독립적인 개발 및 운영 환경을 구성합니다.
* 각 서비스별로 개발, 스테이징, 운영 환경을 갖추어 변경 사항을 개별적으로 검증합니다.
* 서비스 간 통합 테스트를 위한 공통 테스트 환경을 구축합니다.
#### 컨테이너로 배포하면?
컨테이너화된 마이크로서비스를 사용하면 환경 간 일관성을 유지하면서도 손쉽게 분리할 수 있습니다.
#### 오케스트레이션 환경에서 배포하면?
Kubernetes 등의 오케스트레이션 도구를 활용하여 네임스페이스와 레이블을 사용하면 개발 환경과 운영 환경을 논리적으로 구분할 수 있습니다.
<br/><br/>

---

### 참조
* [인프런 QnA - 하나의 가상서버에 테스트 서버와 운영 서버를 관리하는 방법
](https://www.inflearn.com/community/questions/1193887/%ED%95%98%EB%82%98%EC%9D%98-%EA%B0%80%EC%83%81%EC%84%9C%EB%B2%84%EC%97%90-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%84%9C%EB%B2%84%EC%99%80-%EC%9A%B4%EC%98%81-%EC%84%9C%EB%B2%84%EB%A5%BC-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95?srsltid=AfmBOoqym15czjTSJ5uTyzvL9PY6ojvS__IdUrpKBx3VacDVKUfemagG)
* [블로그 - 개발 환경(dev,stage,qa,production)](https://bcho.tistory.com/759)
* [아티클 - Deploying vs Releasing Software: What’s The Difference?](https://www.bmc.com/blogs/software-deployment-vs-release/)
